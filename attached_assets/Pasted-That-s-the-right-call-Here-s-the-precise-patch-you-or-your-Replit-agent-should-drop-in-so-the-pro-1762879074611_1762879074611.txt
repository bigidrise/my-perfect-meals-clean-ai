That‚Äôs the right call.
Here‚Äôs the precise patch you or your Replit agent should drop in so the **production build resolves the backend URL correctly** on Railway.

---

### üß© File

`client/src/lib/macrosApi.ts`

---

### ‚úÖ Replace existing function with this version

```ts
// client/src/lib/macrosApi.ts
import { apiRequest } from "@/lib/queryClient";

// Use dynamic base URL so it works on Replit (localhost) and Railway (production)
const API_BASE =
  typeof window !== "undefined" ? window.location.origin : "";

export async function saveMacrosLog({
  dateISO,
  mealType,
  calories,
  protein,
  carbs,
  fat,
}: {
  dateISO: string;
  mealType: string;
  calories: number;
  protein: number;
  carbs: number;
  fat: number;
}) {
  try {
    const response = await fetch(`${API_BASE}/api/biometrics/log`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      credentials: "include", // ensures cookies/session carry through in production
      body: JSON.stringify({
        date_iso: dateISO,
        meal_type: mealType,
        calories_kcal: calories,
        protein_g: protein,
        carbs_g: carbs,
        fat_g: fat,
      }),
    });

    if (!response.ok) {
      const errorText = await response.text();
      console.error("‚ùå Biometrics log failed:", errorText);
      throw new Error(`Biometrics API failed: ${response.statusText}`);
    }

    return await response.json();
  } catch (err) {
    console.error("üí• Biometrics API error:", err);
    throw err;
  }
}
```

---

### üß† Why this works

* **`window.location.origin`** dynamically resolves to

  * `http://localhost:5173` on Replit dev
  * your Railway domain in production (e.g., `https://my-perfect-meals-production.up.railway.app`)
* **`credentials: 'include'`** ensures the browser sends your session or auth cookies.
* **Full error logging** will now show in the console if the API call fails, instead of silently refreshing.

---

### ‚úÖ Expected behavior after deploy

1. Click **Send to Biometrics** in Macro Counter.
2. In Railway Logs you‚Äôll now see:

   ```
   POST /api/biometrics/log 200 OK
   üì• Received biometrics log: {...}
   ```
3. Frontend will navigate normally to `/my-biometrics`.
4. The new macros entry will appear under today‚Äôs date.

---

### üßæ Commit message

```
./push.sh "Fixed Biometrics API base resolution for Railway; added full URL and error logging"
```

---

After this deploys, if you still see a refresh instead of a redirect, open your browser console ‚Äî you‚Äôll get the exact error message from the new logger, and we can trace it instantly.
