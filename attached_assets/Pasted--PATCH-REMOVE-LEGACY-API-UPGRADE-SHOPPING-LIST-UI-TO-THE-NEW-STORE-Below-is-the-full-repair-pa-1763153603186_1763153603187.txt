üü• PATCH: REMOVE LEGACY API + UPGRADE SHOPPING LIST UI TO THE NEW STORE

Below is the full repair patch.
It has 3 sections, each one critical:

1Ô∏è‚É£ Delete ALL legacy compatibility exports
2Ô∏è‚É£ Apply the correct new exports to the store
3Ô∏è‚É£ Update all UI components to call the correct new functions

SECTION 1 ‚Äî DELETE ALL LEGACY COMPATIBILITY EXPORTS

File: client/src/stores/shoppingListStore.ts

Remove the following functions entirely (delete them from the file):

// DELETE ALL OF THESE
export function readList() {}
export function setItems() {}
export function toggleChecked() {}
export function deleteItems() {}
export function updateItem() {}
export function clearAll() {}
export function clearChecked() {}
export function readOptions() {}
export function writeOptions() {}
export function setWeekScope() {}


These were introduced as temporary shims and MUST be removed.

SECTION 2 ‚Äî EXPORT ONLY THE NEW OFFICIAL API

Replace your store exports with ONLY these:

// KEEP ONLY THESE EXPORTS
export const useShoppingListStore = create<ShoppingListState>(...)

export const loadList = () =>
  useShoppingListStore.getState().loadList();

export const saveList = () =>
  useShoppingListStore.getState().saveList();

export const clearList = () =>
  useShoppingListStore.getState().clearList();

export const addServerItems = (items: UniversalIngredient[]) =>
  useShoppingListStore.getState().addServerItems(items);

export const deleteItem = (id: string) =>
  useShoppingListStore.getState().deleteItem(id);

export const toggleItem = (id: string) =>
  useShoppingListStore.getState().toggleItem(id);


This is the final, stable, universal-schema compliant API.

SECTION 3 ‚Äî UPDATE UI COMPONENTS TO USE NEW API
Files that MUST be patched:

Your architect needs to search for ANY file importing from the store:

client/src/pages/ShoppingListMasterView.tsx
client/src/components/shopping/ShoppingListEntryView.tsx
client/src/components/shopping/ShoppingListControls.tsx
client/src/components/shopping/ShoppingListSwipeItem.tsx
client/src/components/shopping/ShoppingListHeader.tsx


Then replace EVERY legacy import with this:

import {
  useShoppingListStore,
  loadList,
  saveList,
  clearList,
  deleteItem,
  toggleItem,
  addServerItems
} from '@/stores/shoppingListStore';


Next, update the calls inside the UI to the new API:

‚ùå Old Calls (DELETE EVERY ONE OF THESE)
readList();
clearAll();
clearChecked();
toggleChecked(id);
deleteItems([id]);
updateItem();
writeOptions();
setWeekScope();

‚úÖ Replace With These (THE NEW OFFICIAL CALLS)
loadList();
saveList();
clearList();
toggleItem(id);
deleteItem(id);
addServerItems(items);

üü• SECTION 4 ‚Äî FINAL VALIDATION STEP

Architect must confirm these three facts after applying the patch:

‚úî No file is importing legacy functions

Run:

rg "clearAll|clearChecked|readList|deleteItems|toggleChecked" -n client


Result must be EMPTY.

‚úî Store exports ONLY the 7 allowed functions

(Listed above in Section 2)

‚úî Shopping List Master View loads without fallback crash

The app should load normally with no black screen.

üü© THIS PATCH ‚Äî WHEN APPLIED ‚Äî DOES 3 THINGS:

Stabilizes your shopping list permanently

Cleans out all legacy tech debt

Removes all temporary ‚Äúcompatibility crutches‚Äù

This aligns your entire app with the universal ingredient schema and the new V2 shopping list architecture.

üëç Ready for Architect Delivery

If you want, I can also generate:

a git diff version

a step-by-step agent script

or a full replacement file for any component